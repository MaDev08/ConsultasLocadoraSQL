EXERCÃCIO LISTA 1 BD: 

1-)SELECT * FROM dbo.CLIENTES;

2-)SELECT * FROM dbo.LOCACOES;

3-) SELECT NOME_CATEGORIA FROM dbo.CATEGORIA;

4-)SELECT sexo, CIDADE FROM dbo.CLIENTES
WHERE sexo = 'M' AND CIDADE = 'Sorocaba' ;

5-)SELECT NOME, TELEFONE FROM dbo.CLIENTES
ORDER BY NOME ASC;

6-)SELECT COUNT (*) AS QTD_MULHERES FROM dbo.CLIENTES
WHERE sexo = 'F';

7-) SELECT NOME_CATEGORIA FROM dbo.CATEGORIA	
INNER JOIN dbo.FILME ON dbo.CATEGORIA.COD_CATEGORIA = dbo.FILME.COD_CATEGORIA
ORDER BY NOME_CATEGORIA ASC;

8-)SELECT * FROM dbo.FILME 
WHERE DIRETOR = 'Shawn Levy' AND RESERVADA= 'n';

9-)SELECT * FROM dbo.FILME 
WHERE VALOR_LOCACAO > 5  AND RESERVADA = 's';

10-) SELECT COUNT(DIRETOR)
FROM dbo.FILME;

11-) SELECT COUNT ('RESERVADA')
FROM dbo.FILME;

12-) SELECT MAX (VALOR_LOCACAO)
FROM dbo.FILME;

13-)SELECT * FROM dbo.FILME
WHERE COD_FILME = '1';

14-) SELECT * FROM dbo.FILME
WHERE COD_FILME = '2' OR COD_FILME = '3' AND RESERVADA = 's' AND VALOR_LOCACAO > 5 ;

15-)SELECT * FROM dbo.LOCACOES
WHERE COD_CLIENTE = 7;

16-) SELECT c.NOME, COUNT(l.COD_FILME) AS total_filmes_alugados
FROM dbo.CLIENTES c
JOIN dbo.LOCACOES l ON c.COD_CLIENTE = l.COD_CLIENTE
GROUP BY c.NOME
HAVING COUNT(l.COD_FILME) > 3;


17-) SELECT c.NOME, SUM(f.VALOR_LOCACAO) AS total_gasto
FROM dbo.CLIENTES c
JOIN dbo.LOCACOES l ON c.COD_CLIENTE = l.COD_CLIENTE
JOIN dbo.FILME f ON l.COD_FILME = f.COD_FILME
WHERE c.NOME = 'Renata Cristina'
GROUP BY c.NOME;


18-) SELECT AVG(VALOR_LOCACAO) AS media_valor_locacao
FROM dbo.FILME;


19-)SELECT MIN (VALOR_LOCACAO) AS menor_valor
FROM dbo.FILME;

20-)SELECT cat.NOME_CATEGORIA, COUNT(f.COD_FILME) AS quantidade_filmes
FROM dbo.CATEGORIA cat
JOIN dbo.FILME f ON cat.COD_CATEGORIA = f.COD_CATEGORIA
GROUP BY cat.NOME_CATEGORIA;
